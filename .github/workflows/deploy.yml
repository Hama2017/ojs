Enhance deployment workflow to support automatic triggers and improve environment detection